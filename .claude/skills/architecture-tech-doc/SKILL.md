---
name: architecture-tech-doc
description: 为现有代码仓库生成架构文档与技术文档，并列出缺失信息清单；当用户提供仓库结构、关键文件摘要、依赖与运行方式等上下文且需要编写架构/技术文档时使用。
---

# 仓库架构与技术文档生成器

## Instructions

1. 先确认用户已提供仓库上下文：目录结构、关键文件内容或摘要、依赖与运行方式、配置/env、外部服务、主要用例。若缺失，请先询问或标记缺口。
2. 输出两部分：**架构文档** 和 **技术文档**，按下述小节分点撰写；内容要结合仓库实际，避免空洞描述。
3. 若需生成 Mermaid 架构图，遵循本目录的 `mermaid.md` 规范要点：
   - 使用 `graph TB`，不要用 `C4Context`；节点用 `[文本]`，路径避免前导斜杠。
   - 颜色：容器浅色、节点深 2-3 阶；无边框，节点圆角 10，容器圆角 15；文本黑色。
   - 连接：主链 `-->`，可选依赖 `-.->`，可加标签 `-->|说明|`。
   - 参考配色表与示例：本目录 `mermaid.md`（客户端/前端/API/业务/数据/外部服务配色）。

### 架构文档（面向架构/产品/研发管理层）

- 目标与问题域：项目要解决什么问题，核心价值。
- 架构视图：整体架构（前端/后端/数据/模型/消息队列/缓存/存储），主要模块与边界，依赖关系。
- 关键设计决策：技术栈/框架/模式的选择理由与取舍。
- 数据流与控制流：请求路径、主要用例的流程说明。
- 运行与部署：运行环境、配置方式（env/secret）、构建与发布流程，外部服务依赖。
- 性能与弹性：扩展点、缓存策略、并发/吞吐/延迟关注点。
- 安全与合规：鉴权/授权、敏感信息处理、日志/审计。
- 可靠性：容错、重试、幂等、健康检查、监控与告警。

### 技术文档（面向开发）

- 目录结构与关键文件说明。
- 技术栈与依赖：语言版本、框架、包管理、主要三方服务。
- 配置与环境：env 示例、必需密钥/变量，本地/测试/生产切换方式。
- 启动与运行：本地运行命令、调试方法、常见问题。
- 构建与发布：构建命令、CI/CD 流程、制品与版本规范。
- 模块/接口说明：核心模块职责与接口；主要 API/路由/消息主题的输入输出示例。
- 数据与存储：数据库/缓存/文件存储的表/集合/索引或目录约定。
- 测试与质量：测试命令、覆盖范围、规范（lint/format/typecheck），如何新增用例。
- 观测性：日志格式、指标、追踪、仪表盘。

4. 若信息不足，追加「信息缺失清单」，点出需要用户补充的具体项。
5. 语言默认与用户输入一致；保持简洁分点输出，必要时用小标题分隔。

## Examples

- 用户提供仓库结构与关键文件摘要，请输出架构文档、技术文档，并附缺失信息清单（如缺少部署环境、API 密钥策略等）。
- 用户仅提供部分代码片段时，先询问缺失的运行方式/依赖，再生成初稿并标注缺失清单。
